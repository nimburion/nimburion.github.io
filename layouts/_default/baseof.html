<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
  <meta name="description" content="{{ .Description | default .Site.Params.description }}">
  {{ $tokens := resources.Get "css/tokens.css" | resources.Copy "css/tokens.css" }}
  {{ $baseStyles := resources.Get "css/base.css" | resources.Copy "css/base.css" }}
  {{ $layoutStyles := resources.Get "css/layout.css" | resources.Copy "css/layout.css" }}
  {{ $tokensPermalink := $tokens.RelPermalink }}
  {{ $basePermalink := $baseStyles.RelPermalink }}
  {{ $layoutPermalink := $layoutStyles.RelPermalink }}
  {{ $style := resources.Get "css/style.scss" | css.Sass | resources.Minify | resources.Fingerprint }}
  <link rel="stylesheet" href="{{ $style.RelPermalink }}" integrity="{{ $style.Data.Integrity }}">
  <link rel="icon" type="image/svg+xml" href="/assets/images/brand/icon.svg">
  <script>
    (() => {
      try {
        const stored = localStorage.getItem("theme");
        const preferred = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
        document.documentElement.setAttribute("data-theme", stored || preferred);
      } catch (_) {
        document.documentElement.setAttribute("data-theme", "light");
      }
    })();
  </script>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>

  {{ partial "header.html" . }}

  <main id="main-content">
    {{ block "main" . }}{{ end }}
  </main>

  {{ partial "footer.html" . }}
  {{ partial "search.html" . }}

  {{ $searchEntries := slice }}
  {{ range .Site.RegularPages }}
    {{ if hasPrefix .RelPermalink "/documentation/" }}
      {{ $searchEntries = $searchEntries | append (dict
        "title" .Title
        "url" .RelPermalink
        "section" (.Section | title | default "Documentation")
        "summary" (.Summary | plainify | truncate 180)
        "content" (.Plain | truncate 320)
      ) }}
    {{ end }}
  {{ end }}
  <script id="search-index" type="application/json">{{ $searchEntries | jsonify | safeJS }}</script>

  <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js" defer></script>
  {{ $docsScript := resources.Get "js/docs.js" | resources.Minify | resources.Fingerprint }}
  <script src="{{ $docsScript.RelPermalink }}" integrity="{{ $docsScript.Data.Integrity }}" defer></script>
</body>
</html>
